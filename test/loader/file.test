
UTest({
	'file': function(){
		return Config
			.fetch([{
				path: 'test/config/foo.yml',
				
				beforeRead: assert.await(function(source){
					deepEq_(source.config, {});
				}),
				
				afterRead: assert.await(function(source, rootConfig){
					eq_(source.config.foo, 'foo');
					eq_(source.config.combi.foo, 'foo');
				})
			},{
				path: 'test/config/bar/bar.yml'
			}, {
				path: 'test/config/module.js'
			}])
			.done(config => has_(config, {
				foo: 'foo',
				bar: 'bar',
				combi: {
					foo: 'foo',
					bar: 'bar',
					module: 'module'
				}
			}));
	},
	'file synchronous' () {
		var config = Config.fetch([
			{ path: 'test/config/foo-sync.yml' },
			{ path: 'test/config/bar/bar.yml' }
		], { sync: true });

		has_(config.toJSON(), {
			foo: 'foo-sync',
			bar: 'bar',
			combi: {
				foo: 'foo-sync',
				bar: 'bar'
			}
		});
	}
});